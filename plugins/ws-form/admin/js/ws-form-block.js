'use strict';

var el 					= wp.element.createElement,
	register_block_type = wp.blocks.registerBlockType,
	block_style			= { backgroundColor: '#900', color: '#fff', padding: '20px' },
	icon_el 			= el(

		'svg',
		{ width: 20, height: 20, class: 'dashicon' },
		el(
			'path',
			{ d: "M0 0v20h20V0zm8.785 13.555h-.829l-1.11-4.966c-.01-.036-.018-.075-.026-.115l-.233-1.297h-.014l-.104.574-.17.838-1.147 4.966h-.836L2.57 6.224h.703l.999 4.27.466 2.23h.044q.133-.966.43-2.243l.998-4.257h.74l1.006 4.27q.119.48.422 2.23h.044q.022-.223.219-1.121t1.254-5.379h.695zm5.645-.389a2.105 2.105 0 0 1-1.54.524 3.26 3.26 0 0 1-.961-.129 2.463 2.463 0 0 1-.644-.283l.309-.534a1.274 1.274 0 0 0 .416.186 2.78 2.78 0 0 0 .925.152 1.287 1.287 0 0 0 .977-.372 1.377 1.377 0 0 0 .355-.993 1.313 1.313 0 0 0-.255-.821 3.509 3.509 0 0 0-.973-.76 6.51 6.51 0 0 1-1.121-.757 2.121 2.121 0 0 1-.466-.635 1.94 1.94 0 0 1-.167-.838A1.67 1.67 0 0 1 11.87 6.6a2.161 2.161 0 0 1 1.487-.517 2.76 2.76 0 0 1 1.567.446l-.31.534a2.425 2.425 0 0 0-1.287-.372 1.422 1.422 0 0 0-.991.334 1.132 1.132 0 0 0-.37.882 1.298 1.298 0 0 0 .252.814 3.792 3.792 0 0 0 1.065.794 6.594 6.594 0 0 1 1.095.767 1.896 1.896 0 0 1 .44.635 2.076 2.076 0 0 1 .144.8 1.94 1.94 0 0 1-.532 1.45zm2.375.598a.671.671 0 1 1 .672-.671.671.671 0 0 1-.672.67zm0-3.242a.671.671 0 1 1 .672-.671.671.671 0 0 1-.672.67zm0-3.284a.671.671 0 1 1 .672-.672.671.671 0 0 1-.672.672z" }
		)
	);

register_block_type('wsf-block/form-add', {

    title: wsf_settings_block.title,

    icon: icon_el,

    category: 'common',

	attributes: {

		form_id: {

			type: 'string',
			default: '0'
		}
	},

    edit: function(props) {

		function set_form_id(event) {

			var selected = event.target.querySelector('option:checked');
			props.setAttributes({form_id: selected.value});
			event.preventDefault();
		}

		var focus = props.focus;

		var form_id = props.attributes.form_id;
		if(!form_id) { formID = ''; }

		var children = [];

		// Build logo
		var logo = el('svg', { width: '87.5508', height: '25', viewBox: '0 0 87.5508 25', class: 'components-placeholder__label'},

			el('defs', {}, el('style', {}, '.a{fill:#002d5d;}.b{fill:#aca199;}')),
			el('path', { class: 'a', d: 'M12.5579,24.6849,9.9705,13.1065q-.0348-.126-.06-.2678T9.3667,9.8141H9.3323l-.2416,1.339L8.694,13.1065,6.02,24.6849H4.071L0,7.5929H1.6387l2.3287,9.9559,1.0868,5.1985h.1035q.31-2.2525,1.0006-5.23L8.4869,7.5929H10.212l2.3459,9.9559q.2758,1.1187.9833,5.1985h.1035q.0517-.52.5089-2.615T17.0775,7.5929h1.6214L14.49,24.6849ZM28.8937,20.4a4.5216,4.5216,0,0,1-1.242,3.379A4.9076,4.9076,0,0,1,24.0637,25a7.5923,7.5923,0,0,1-2.2424-.2992,5.7442,5.7442,0,0,1-1.5008-.6616l.7189-1.2437a2.9736,2.9736,0,0,0,.9716.4324,6.48,6.48,0,0,0,2.1562.3544,3,3,0,0,0,2.277-.8664,3.2114,3.2114,0,0,0,.828-2.3157,3.0622,3.0622,0,0,0-.5951-1.914,8.1752,8.1752,0,0,0-2.2684-1.7721A15.1856,15.1856,0,0,1,21.7953,14.95a4.9517,4.9517,0,0,1-1.0867-1.4807,4.5249,4.5249,0,0,1-.3882-1.9535,3.893,3.893,0,0,1,1.3628-3.0481,5.04,5.04,0,0,1,3.4673-1.2051,6.4339,6.4339,0,0,1,3.6523,1.0394l-.72,1.2447A5.657,5.657,0,0,0,25.0815,8.68a3.3159,3.3159,0,0,0-2.3115.78,2.6372,2.6372,0,0,0-.8625,2.0557,3.0251,3.0251,0,0,0,.5865,1.8982,8.8362,8.8362,0,0,0,2.484,1.851,15.3686,15.3686,0,0,1,2.553,1.788,4.42,4.42,0,0,1,1.0264,1.4808A4.8438,4.8438,0,0,1,28.8937,20.4Z' }),
			el('path', { class: 'b', d: 'M37.5751,8.9162H34.6427V24.6849H33.0212V8.9162H30.6407l.01-1.2993h2.3512l.019-1.4889c0-2.174.2072-3.5575.7825-4.5063A3.3218,3.3218,0,0,1,36.7989,0H38.484V1.38c-.3763,0-1.1017.0119-1.596.0208a1.8186,1.8186,0,0,0-1.4629.5678A2.5345,2.5345,0,0,0,34.85,3.3239a15.0853,15.0853,0,0,0-.2069,2.8355V7.5929h2.9324ZM50.0265,16.1a12.1351,12.1351,0,0,1-1.4922,6.6083A4.7969,4.7969,0,0,1,44.265,25a4.6852,4.6852,0,0,1-4.2-2.2921A12.3644,12.3644,0,0,1,38.607,16.1q0-8.8374,5.7269-8.8374a4.731,4.731,0,0,1,4.1918,2.3156A11.9619,11.9619,0,0,1,50.0265,16.1Zm-9.7117,0a12.6811,12.6811,0,0,0,.966,5.5923,3.1829,3.1829,0,0,0,3.0187,1.89q4.0191,0,4.0192-7.4827,0-7.42-4.0192-7.42a3.1746,3.1746,0,0,0-3.0446,1.8589,12.7606,12.7606,0,0,0-.94,5.5608Zm12.319-4.6326c0-2.0732,2.5052-4.182,5.1672-4.2048a5.5765,5.5765,0,0,1,3.1027.7989L60.0929,9.32a4.593,4.593,0,0,0-2.3264-.5769,3.2806,3.2806,0,0,0-2.0947.541,2.6917,2.6917,0,0,0-1.38,2.3837c-.1276,1.1062-.0442,2.6782-.0442,3.9594v9.0579H52.6087m8.5382-13.514a4.5923,4.5923,0,0,1,4.7025-3.9242,5.5571,5.5571,0,0,1,2.9327.8453,3.0205,3.0205,0,0,1,1.1866,1.8808,3.5268,3.5268,0,0,1,1.4679-1.8293,4.3894,4.3894,0,0,1,2.5521-.8669A4.2672,4.2672,0,0,1,77.6592,8.939c.6774.9775.9833,2.3928.9833,4.5771V24.6849H77.0208V13.0435c.0416-3.32-.8366-4.3869-3.0321-4.3869a2.4849,2.4849,0,0,0-2.462,1.2771,10.5547,10.5547,0,0,0-.8365,4.7481V24.6849H69.0686V13.0435a6.1661,6.1661,0,0,0-.6727-3.2372,3.075,3.075,0,0,0-2.4993-1.0869,2.8435,2.8435,0,0,0-2.6417,1.637c-.5635,1.0294-.5,2.63-.5,4.94v9.3888H61.1164m24.518-18.32-.12-.0017.0238-1.6613-.3566-.0052.0016-.1141.8334.0119-.0016.1142-.3567-.0051Zm1.163.0167-.4535-1.6233h-.01q.0087.2552.0077.3232l-.0185,1.2934-.1152-.0017.0254-1.7755.1777.0026.3825,1.3634a1.9491,1.9491,0,0,1,.0654.3071h.01a2.3771,2.3771,0,0,1,.08-.3025l.4177-1.3545.1839.0027-.0255,1.7755-.12-.0018.0184-1.2836q.0012-.0753.0169-.33l-.01,0L86.9334,6.383Z'}),
			el('circle', { class: 'b', cx: '82.4467', cy: '8.7208', r: '1.4741' }),
			el('circle', { class: 'b', cx: '82.4467', cy: '15.9332', r: '1.4741' }),
			el('circle', { class: 'b', cx: '82.4467', cy: '23.0529', r: '1.4741' })
		);

		children.push(logo);

		if(wsf_settings_block.forms.length > 0) {

			var intro = el('div', { class: 'components-placeholder__instructions' } , wsf_settings_block.intro);
			children.push(intro);

			var options = [];
			options.push(el('option', { value: 0 }, wsf_settings_block.select));
			for(var form_index in wsf_settings_block.forms) {

				var form = wsf_settings_block.forms[form_index];
				options.push(el('option', { value: form.id }, form.label + ' (' + wsf_settings_block.id + ': ' + form.id + ')'));
			}

			children.push(

				el('select', {value: form_id, onChange: set_form_id}, options)
			);

		} else {

			var intro = el('div', { class: 'components-placeholder__instructions' }, [

				wsf_settings_block.intro_no_forms + ' ',
				el('a', { class: 'components-placeholder__instructions', href: wsf_settings_block.intro_no_forms_link }, wsf_settings_block.intro_no_forms_link_text)
			]);
			children.push(intro);
		}

		var body = el('div', { class: 'components-placeholder'}, children);

        return el('form', { onSubmit: set_form_id }, body);
    },

	save: function(props) {

		return null;
	}
} );